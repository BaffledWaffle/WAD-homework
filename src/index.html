<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="assets/styles/style.css">
    <link rel="stylesheet" href="assets/styles/flex.css">
    <link rel="stylesheet" href="assets/styles/index.css">
    <title>PARAPAPA</title>
</head>
<body>
    <div class="wrapper">
        <nav id="navbar">
            <div id="header-links-container">                   
                <a href="index.html" target="_self"  class="nav-link">Home</a>
                <span id="divider">|</span>
                <a href="addPost.html" target="_self"  class="nav-link">Add post</a>
            </div>                                
                <!-- <div id="account-image-container">                
                    <a href="login.html" target="_self"  class="nav-link"><img src="assets/img/account_circle.svg" alt=""></a> -->

            <div id="account">
                <div id="account-image-container">
                    <a  class="nav-link"><img src="assets/img/account_circle.svg" alt="" id="account-img"></a>

                    <div id="myDropdown" class="dropdown-content">
                    <a href="#">username</a>
                    <a href="#">email</a>
                    <a href="login.html">Log in out</a>
                    </div>
                </div>
            </div>
        </nav>
        <div id="content">
            <div id="content-positioner">
                <div class="sidebar left"></div>
                <div id="feed-of-posts">
                        <!-- from json-->
                </div>
                <div class="sidebar right"></div>
            </div>
        </div>

        <footer>
            <div id="columns-container">
                <div class="column">
                    <h2>Pages</h2>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="addPost.html">Add Post</a></li>
                        <li><a href="login.html">Log In</a></li>
                    </ul>
                </div>
                <div class="column">
                    <h2>Quote of the moment</h2>
                    <p id="footer-quote"></p>
                </div>
                <div class="column">
                    <h2>Our team</h2>
                    <p>Evelina</p>
                    <p>Nele Taisi</p>
                    <p>Jevgeni</p>
                </div>
            </div>
            <div id="copyright">
                Â© 2025-2026 Autumn WAD, Group 2, AH
            </div>
        </footer>
    </div>
    
    <!-- NEW dropdown menu-->
    <script>
        document.addEventListener("DOMContentLoaded", function() {
        const accountImg = document.getElementById("account-img");
        const dropdown = document.getElementById("myDropdown");

        accountImg.addEventListener("click", function(event) {
            event.stopPropagation(); 
            dropdown.classList.toggle("show");
        });

        // close dropdown menu if clicked
        document.addEventListener("click", function() {
            dropdown.classList.remove("show");
        });
        });
</script>



    <script> /*Displays a new quote in the footer every time the page refreshes*/
    document.addEventListener("DOMContentLoaded", function() {
        const quotes = [
            "Life is better with a slice of pizza",
            "Creativity takes courage",
            "Seashells are whispers of the ocean",
            "A day without laughter is a day wasted",
            "Small steps lead to big adventures",
            "Share your ideas, inspire the world",
            "If we had not been born, there would be no problems, then we would not have been born, we would not exist (c) Evelina"
        ];

        const randomIndex = Math.floor(Math.random() * quotes.length);

        document.getElementById("footer-quote").textContent = quotes[randomIndex];
    });
    </script>


    <!-- NEW. json usage  with URL-->
     <script>
    document.addEventListener("DOMContentLoaded", function() {
    const url = 'https://api.jsonbin.io/v3/b/6904951bae596e708f39ffc3';
    //const path = 'assets/json/posts.json'   DO NOT WORK maybe problem with fetch, or we need to do directly in js our json...


    fetch(url)  // fetch(url) if json from website
        .then(response => response.json())
        .then(data => {
            const posts = data.record; // for url 
            //const posts = data; for local usage?
            const feed = document.getElementById('feed-of-posts');
            const postsArray = Array.isArray(posts) ? posts : [posts];

            postsArray.forEach(post => {
                const postDiv = document.createElement('div');
                postDiv.className = 'post';

                postDiv.innerHTML = `
                    ${post.image_path ? `
                    <div class="post-images">
                        <img src="${post.image_path}" alt="post">
                    </div>` : ''}
                    
                    <div class="avatar-text">
                        <div class="user-avatar"><img src="${post.avatar_path}" alt="user-avatar"></div>
                        <div class="text">
                            <p class="usernames">${post.author}</p>
                            <p class="main-text">${post.description}</p>
                            <button>Show more</button>
                            <div class="post-like">
                                <button></button>
                                <p>${post.likes}</p>
                            </div>
                        </div>
                    </div>
                `;

                feed.appendChild(postDiv);

                // ===== Show more functionality for dynamic posts =====
                const text = postDiv.querySelector(".main-text");
                const button = postDiv.querySelector("button");

                // measure full height
                const clone = text.cloneNode(true);
                clone.style.visibility = "hidden";
                clone.style.position = "absolute";
                clone.style.height = "auto";
                clone.style.webkitLineClamp = "unset";
                clone.classList.add("expanded");
                document.body.appendChild(clone);

                if (clone.offsetHeight <= text.offsetHeight) button.style.display = "none";
                clone.remove();

                button.addEventListener("click", function() {
                    text.classList.toggle("expanded");
                    this.textContent = text.classList.contains("expanded") ? "Show less" : "Show more";
                });
            });
        })
        .catch(error => console.error('Error loading JSON:', error));
    });
    </script>

</body>
</html>